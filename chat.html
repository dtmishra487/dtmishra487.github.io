<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Talk to Shu!</title>
</head>
<body>

    <h1>Talk to Shu!</h1>

    <input type="text" id="userInput" placeholder="Type a message...">
    <button onclick="addMessage()">Send</button>
    <button onclick="clearMessages()">Clear All</button>

    <hr>
    <h2>Live Messages:</h2>
    <ul id="outputArea">Loading...</ul>

    <script type="module">
        // 1. Import the tools we need from Firebase
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getDatabase, ref, push, onValue, set } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

        // 2. PASTE YOUR CONFIGURATION HERE vvv
        // (Replace this block with the code you copied from Firebase Console)
       const firebaseConfig = {
  apiKey: "AIzaSyCgz9glYGU4XrYOLyOx42eDnMsxEWAyW60",
  authDomain: "chatting-392af.firebaseapp.com",
  databaseURL: "https://chatting-392af-default-rtdb.firebaseio.com",
  projectId: "chatting-392af",
  storageBucket: "chatting-392af.firebasestorage.app",
  messagingSenderId: "833317429026",
  appId: "1:833317429026:web:3e8396f4506f8123d40f7b",
  measurementId: "G-XPM4SG68C1"
};
        // ^^^ END CONFIGURATION

        // 3. Start Firebase
        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);
        const messagesRef = ref(db, 'messages');

        // 4. FUNCTION: Send Data
        window.addMessage = function() {
            const inputElement = document.getElementById("userInput");
            const msg = inputElement.value;

            if (msg.trim() === "") return;

            // Save to database
            push(messagesRef, {
                text: msg
            });

            inputElement.value = ""; // Clear box
        }

        // 5. FUNCTION: Clear Data
        window.clearMessages = function() {
            set(messagesRef, null); // Deleting the 'messages' node clears it
        }

        // 6. LISTENER: Update Screen Automatically
        onValue(messagesRef, (snapshot) => {
            const outputElement = document.getElementById("outputArea");
            outputElement.innerHTML = ""; // Reset list
            
            const data = snapshot.val();
            
            if (data) {
                // Loop through messages and display them
                Object.values(data).forEach(msg => {
                    outputElement.innerHTML += `<li>${msg.text}</li>`;
                });
            } else {
                outputElement.innerHTML = "No messages yet.";
            }
        });
    </script> 
</body>
</html>
